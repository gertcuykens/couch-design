<!DOCTYPE html>
<!-- Copyright(c) gert.cuykens@gmail.com -->
<html>
 <head>
  <title>user</title>
  <link type="text/css" href="user.css" rel="stylesheet"/>
  <script src="http.js"></script>
 </head>
 <body>

  <form name="dropBox" action="javascript:return null">
   <img id="picture" alt="picture" src="/users/gert/picture.png"/>
   <script>dropBox(document.getElementById('picture'))</script>
  </form>

  <form name="user" action="javascript:user()">
   <label>adress:</label>  <input name="adress" /><br/>
   <label>city:</label>    <input name="city"   /><br/>
   <label>country:</label> <input name="country"/><br/>
   <label>phone:</label>   <input name="phone"  /><br/>
   <label>email:</label>   <input name="email"  /><br/>
   <input type="submit" value="update"/>
   <script>
    get=function(){
     var i,v=JSON.parse(userx.response)
     for(i in v){if(document.user[i])document.user[i].value=v[i]}
     userx.removeEventListener('load',get,false)
     userx.addEventListener('load',function(){ETag=userx.getResponseHeader('X-Couch-Update-NewRev')},false)
    }
    userx=new xhr()
    userx.open('get','/users/gert',true)
    userx.addEventListener('load',get,false)
    userx.send()
    user=function(){
     userx.open('put','_update/form/gert',true);
     userx.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
     userx.setRequestHeader('If-Match',ETag);
     userx.send(formURI(document.user));
    }
   </script>
  </form>

  <form name="login" action="javascript:login()">
   <label>name:</label>     <input name="name"/><br/>
   <label>password:</label> <input name="password"/><br/>
   <input type="submit" value="login"/><br/>
   <script>
    loginx=new xhr()
    login=function(){
     loginx.open('post','/_session',true)
     loginx.setRequestHeader('Content-Type','application/x-www-form-urlencoded')
     loginx.send(formURI(document.login))
    }
   </script>
  </form>

  <form name="oauth2" action="javascript:oauth2()">
   <input type="submit" value="oauth2"/><br/>
   <script>
    url='https://accounts.google.com/o/oauth2/auth?\
         client_id=21302922996.apps.googleusercontent.com&\
         redirect_uri=https://www.example.com/back&\
         scope=https://www.google.com/m8/feeds/&\
         response_type=token'
    oauth2x=new xhr()
    oauth2=function(){
     oauth2x.open('get',url,true)
     oauth2x.send()
    }
   </script>
  </form>

 </body>
</html>
